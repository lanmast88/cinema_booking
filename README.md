## Cinema Booking — сервис бронирования билетов в кино

Многостраничное веб‑приложение для поиска кинотеатров и фильмов, выбора сеансов и интерактивного бронирования мест в зале. Проект разделён на современный SPA‑фронтенд (React + Vite) и высокопроизводительный REST API (FastAPI + PostgreSQL).

---

## Содержание

1. [Общая информация](#общая-информация)
2. [Функциональность](#функциональность)
3. [Технологический стек](#технологический-стек)
4. [Архитектура и структура репозитория](#архитектура-и-структура-репозитория)
5. [Запуск проекта локально](#запуск-проекта-локально)
   - [Требования](#требования)
   - [Настройка backend](#настройка-backend)
   - [Настройка frontend](#настройка-frontend)
6. [Переменные окружения](#переменные-окружения)
7. [API](#api)
8. [UI и пользовательский сценарий](#ui-и-пользовательский-сценарий)
9. [Скриншоты](#скриншоты)
10. [Диаграммы архитектуры](#диаграммы-архитектуры)
11. [Тестирование](#тестирование)
12. [Планы по развитию](#планы-по-развитию)

---

## Общая информация

**Cinema Booking** решает задачу онлайн‑бронирования билетов в кинотеатр:

- **пользователь** просматривает список кинотеатров и фильмов, выбирает сеанс и конкретные места в зале;
- **система** хранит информацию о кинотеатрах, залах, фильмах, сеансах и заказах, проверяет доступность мест и предотвращает двойное бронирование;
- **администратор** (через отдельные эндпоинты API) управляет справочниками: кинотеатры, залы, фильмы, расписание, цены.

Проект может использоваться как:

- учебный пример полнофункционального SPA + REST API;
- демонстрация навыков работы с React, FastAPI, PostgreSQL, архитектурой клиент‑сервер.

---

## Функциональность

- **Каталог кинотеатров и фильмов**
  - просмотр списка кинотеатров, залов и текущего репертуара;
  - фильтрация по городу, кинотеатру, дате и фильму.

- **Расписание сеансов**
  - отображение доступных сеансов по выбранному фильму/кинотеатру;
  - работа с часовыми поясами и датами показа.

- **Интерактивное бронирование мест**
  - визуальная схема зала с разметкой рядов и мест;
  - отображение занятых/свободных мест;
  - проверка коллизий бронирования на уровне сервера.

- **Работа с заказами**
  - создание заказа на основе выбранных мест;
  - статус заказа (создан, оплачен, отменён);
  - возможность дальнейшей интеграции с платёжными системами.

- **Аутентификация и авторизация**
  - REST‑эндпоинты для регистрации/логина;
  - JWT‑аутентификация (RS256) на backend;
  - заготовка под роли `client` и `admin`.

Дополнительные детали по backend см. в `server/README.md`.

---

## Технологический стек

- **Frontend**
  - **React** 19 (SPA)
  - **Vite** 7 (сборка и dev‑сервер)
  - **React Router DOM** 7 (маршрутизация)
  - **Tailwind CSS** 4 + дополнительные UI‑компоненты (`@headlessui/react`, `@heroicons/react`, `@tailwindplus/elements`)
  - **Axios** — HTTP‑клиент для общения с API

- **Backend**
  - **Python** 3.12
  - **FastAPI** 0.129 — основной веб‑фреймворк
  - **SQLAlchemy (async)** 2.x — ORM и работа с PostgreSQL
  - **PostgreSQL + asyncpg** — основная БД
  - **Alembic** — миграции схемы БД
  - **Pydantic / pydantic‑settings** — валидация данных и конфигурация
  - **Uvicorn** — ASGI‑сервер

- **Инфраструктура и прочее**
  - `.env`‑конфигурация через `python-dotenv`
  - логирование запросов и ошибок через стандартный `logging` + кастомная конфигурация
  - CORS настроен для фронтенда на `http://localhost:5173` (по умолчанию)

---

## Архитектура и структура репозитория

Репозиторий организован как монорепо с двумя основными приложениями: `client` (frontend) и `server` (backend).

```text
cinema_booking_project/
├── client/               # SPA-фронтенд на React + Vite
│   ├── src/
│   │   ├── components/   # Переиспользуемые UI-компоненты (Header, Footer, BurgerMenu и др.)
│   │   ├── pages/        # Страницы приложения (MainPage, PromotionPage и др.)
│   │   └── ...           # Маршрутизация, сервисы, стили
│   ├── index.html
│   ├── package.json
│   └── README.md         # README, специфичный для фронтенда
│
├── server/               # REST API на FastAPI
│   ├── app/
│   │   ├── api/v1/       # Роутеры: auth, cinemas, halls, movies, screenings, orders
│   │   ├── core/         # Конфигурация, логирование
│   │   ├── db/           # Подключение к БД (AsyncSession, engine)
│   │   ├── models/       # ORM-модели
│   │   ├── schemas/      # Pydantic-схемы запросов/ответов
│   │   └── main.py       # Точка входа приложения FastAPI
│   ├── alembic/          # Миграции БД
│   ├── .env              # Переменные окружения backend (не для коммита)
│   ├── README.md         # README, специфичный для backend
│   └── ...
│
├── .gitignore
└── README.md             # Этот файл — основное описание проекта
```

На уровне HTTP взаимодействия:

- фронтенд обращается к REST API по URL вида `http://localhost:8000/api/v1/...`;
- backend предоставляет документацию OpenAPI/Swagger по адресу `http://localhost:8000/docs`;
- CORS на сервере настроен так, чтобы принимать запросы с доменов фронтенда.

---

## Запуск проекта локально

### Требования

- **Node.js**: 18+ (рекомендуется LTS)
- **npm** или **pnpm** / **yarn** (примеры ниже даны для npm)
- **Python**: 3.12
- **PostgreSQL**: 13+ (локально или управляемый сервис)

Дополнительно для удобства:

- [uv](https://docs.astral.sh/uv/) — современный менеджер виртуальных окружений и зависимостей Python.

---

### Настройка backend

Подробное описание есть в `server/README.md`. Ниже — краткий конспект.

1. **Перейти в директорию backend**

```bash
cd server
```

2. **Установить зависимости**

Вариант через `uv`:

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh  # один раз
uv sync                                         # создаст виртуальное окружение и установит зависимости
```

Или классический вариант (если uv не используется):

```bash
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

3. **Сконфигурировать `.env`**

Создайте файл `server/.env` (см. раздел [Переменные окружения](#переменные-окружения)).

4. **Применить миграции БД**

```bash
alembic upgrade head
```

5. **Запустить backend‑сервер**

```bash
uv run uvicorn app.main:app --reload
# или, без uv:
uvicorn app.main:app --reload
```

По умолчанию API будет доступно по адресу:

- `http://localhost:8000` — базовый URL
- `http://localhost:8000/docs` — Swagger UI

---

### Настройка frontend

1. **Перейти в директорию фронтенда**

```bash
cd client
```

2. **Установить зависимости**

```bash
npm install
```

3. **Запустить dev‑сервер**

```bash
npm run dev
```

По умолчанию Vite запустит приложение на:

- `http://localhost:5173`

Убедитесь, что CORS в backend разрешает данный origin (см. `server/.env` и раздел ниже).

---

## Переменные окружения

### Backend (`server/.env`)

**Важно:** не коммитьте реальные креды и секреты в репозиторий.

Пример содержимого файла `.env`:

```env
# Подключение к PostgreSQL
DATABASE_URL=postgresql+asyncpg://user:password@host:5432/cinema_db

# CORS: список разрешённых origins (фронтенд)
CORS_ORIGINS=["http://localhost:5173","http://localhost:3000"]

# Логирование
LOG_LEVEL=INFO
# LOG_FILE=logs/app.log  # при необходимости логирования в файл
```

- **`DATABASE_URL`** — DSN для PostgreSQL. Формат `postgresql+asyncpg://user:password@host:port/dbname`.
- **`CORS_ORIGINS`** — JSON‑массив строк с URL фронтендов, которым разрешён доступ к API.
- **`LOG_LEVEL`** — уровень логирования: `DEBUG`, `INFO`, `WARNING`, `ERROR`.
- **`LOG_FILE`** — путь к файлу логов (опционально).

Фронтенду, как правило, достаточно знать базовый URL API — он может быть вынесен в `.env` Vite (`VITE_API_URL`) или аналогичный механизм.

---

## API

Описание на высоком уровне; детальная документация доступна в Swagger UI (`/docs`) и в `server/README.md`.

- **Базовый URL**: `http://localhost:8000/api/v1`

Основные группы эндпоинтов:

- **Auth** (`/auth`) — регистрация, вход, получение текущего пользователя.
- **Cinemas** (`/cinemas`) — управление кинотеатрами.
- **Halls** (`/halls`) — залы кинотеатров, схема рассадки.
- **Movies** (`/movies`) — фильмы, описание, длительность, возрастные ограничения и др.
- **Screenings** (`/screenings`) — сеансы: дата, время, зал, цена.
- **Orders** (`/orders`) — создание заказа, выбор мест, изменение/отмена.

### Аутентификация

- схема: **JWT Bearer** (RS256);
- клиент отправляет токен в заголовке:

```http
Authorization: Bearer <jwt-token>
```

---

## UI и пользовательский сценарий

На уровне фронтенда реализованы основные пользовательские страницы:

- **Главная страница (`MainPage`)**
  - подборки фильмов и/или сеансов;
  - навигация по кинотеатрам.

- **Страница акций (`PromotionPage`)**
  - отображение текущих спецпредложений, акций и скидок;
  - возможность перейти к выбору фильма/сеанса из акции.

- **Общие компоненты**
  - `Header` — шапка приложения, навигация;
  - `Footer` — футер, контактная информация, ссылки;
  - `BurgerMenu` — адаптивное мобильное меню.

---

## Скриншоты

Раздел для визуальной демонстрации интерфейса.

`<!-- TODO: вставить сюда скриншоты страниц (главная, список фильмов, выбор мест, оформление заказа и т.д.) -->`

Рекомендуемый формат:

- **Скриншот 1** — Главная страница;
- **Скриншот 2** — Список сеансов/фильмов;
- **Скриншот 3** — Схема зала с выбранными местами;
- **Скриншот 4** — Экран подтверждения заказа.

---

## Диаграммы архитектуры

`<!-- TODO: добавить диаграммы архитектуры (PlantUML / Mermaid / изображения) -->`

Рекомендуется добавить:

- **Диаграмму компонент** — frontend ↔ backend ↔ PostgreSQL ↔ внешние сервисы (если появятся).
- **Диаграмму последовательности** для сценария «пользователь бронирует билет».
- **Диаграмму сущностей БД (ER‑диаграмма)** — основные таблицы и связи: User, Cinema, Hall, Movie, Screening, Order, Ticket.

---

## Тестирование

Возможные направления (заготовка раздела, под конкретную реализацию тестов):

- **Backend**
  - юнит‑тесты на бизнес‑логику;
  - интеграционные тесты API через `httpx`/`pytest` с тестовой БД.
- **Frontend**
  - snapshot‑тесты и тесты компонентов (например, через `Vitest`/`Jest` + `Testing Library`);
  - e2e‑тесты через Playwright / Cypress.

`<!-- TODO: описать конкретные команды запуска тестов по мере реализации -->`

---

## Планы по развитию

- **Интеграция оплаты** (Stripe/ЮKassa и др.).
- **Роли и права** для админ‑панели, управление репертуаром через UI.
- **Система промокодов и персонализированных акций**.
- **Локализация** интерфейса (RU/EN) и сообщений об ошибках.
- **Мониторинг и алертинг** (Prometheus/Grafana, Sentry и т.п.).
